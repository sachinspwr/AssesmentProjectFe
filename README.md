# TEST ENGINE BACKEND

This README file provides step-by-step instructions on setting up and running a Node.js Express project.

## Table of Contents

- [Prerequisites](#prerequisites)
- [Installation](#installation)
- [Configuration](#configuration)
- [Running the Project](#running-the-project)
- [Project Structure](#project-structure)
- [Available Scripts](#available-scripts)
- [Sample Endpoints](#sample-endpoints)
- [Developement Guidelines](#developement-guidelines)
- [License](#license)

## Prerequisites

Before you begin, ensure you have the following installed:

- [Node.js](https://nodejs.org/en/download/) (v20.x or later recommended)
- [yarn](https://yarnpkg.com/)
- [typescript](https://www.typescriptlang.org/)

## Installation

1. **Clone the repository**

   ```bash
   git clone https://github.com/your-username/your-repo.git

   ```

1. **Navigate to root directory**

   ```bash
   cd your-repo

   ```

1. **Clone the repository:**
   ```bash
   yarn install
   ```

## Configuration

1. Environment Variables:

   Create a .env file in the root directory of the project and add the following variables:

   ```bash
    NODE_ENV=development
    # Port number
     PORT=4000

    #MySql connection.
    DB_CONNECTION_STRING=conn string value
    DB_USERNAME=db username
    DB_PASSWORD=dbPassword
    DB_TARGETDATABASE=test_engine_db
    DB_HOST=localhost
    DB_PORT=15464
    DB_DIALECT=mysql

    # JWT
    JWT_SECRET=thisisasamplesecret
    JWT_ACCESS_EXPIRATION_MINUTES=30
    JWT_REFRESH_EXPIRATION_DAYS=30
    JWT_RESET_PASSWORD_EXPIRATION_MINUTES=10
    JWT_VERIFY_EMAIL_EXPIRATION_MINUTES=10

    # SMTP Connection
    SMTP_HOST=email-server
    SMTP_PORT=587
    SMTP_USERNAME=email-server-username
    SMTP_PASSWORD=email-server-password
    EMAIL_FROM=support@yourapp.com

   ```

2. Database Setup:

   Ensure your database is set up and accessible with the credentials provided in the .env file.

## Running the Project

1. Development mode:

   For development purposes, you can use nodemon to automatically restart the server on code changes:

   ```bash
   yarn start:dev

   ```

2. Production Mode:

> 1.  Compile app using below command

    ```bash
    yarn run build      # this will build proj and put it in dist folder at root level

> 2.  Run below command to server application

    ```bash
    yarn start:prod     # this will start application from dist folder

3. Access the application
   Open your browser and navigate to http://localhost:4000

## Project Structure

    ├── server.ts                      # Main application file
    ├── app.ts                         # Configuring express app
    ├── package.json                   # Project metadata and dependencies
    ├── src                            # source folder where actual app code lives
        ├── api
            ├── routes/                  # Express route definitions
            │   └── *.route.ts
            ├── controllers/             # Route handlers
            │   └── *.controller.ts
            └── middlewares/            # Custom middleware functions
                └── *.middleware.ts
        ├── config/                     # App Configuration files
        │   └── *.config.ts
        ├── scripts/                    # Scripts for specific operations
        │   └── *.script.ts
        ├── data/                       # Data management code
            ├── migrations/                # Autogenerated Database Migrations
            │   └── *.[migname].js
            ├── models/                    # Database models(seuquelize)
            │   └── *.model.ts
            └── repository/                # Reposity pattern for working with db.
                └── *.repository.ts
        ├── services/                   # Services where business logic resides
        │   └── *.service.ts
        ├── types/                      # Include types, interfaces
        │   └── *.type/interface.ts
        ├── utils/                      # Place for common/sharable code
            ├── enum/                      # Enums
            │   └── *.enum.ts
            ├── errors/                    # Custom errors
            │   └── *.error.ts
            └── helpers/                   # helper functions
                └── *.helper.ts
        ├── .env               # Environment variables
        └── README.md          # This file

## Available Scripts

You will find this scripts in package.json script section, use them whenever necessory.

    1. build  build application
    2. start:prod: Start the server in production mode.
    3. stat:dev: Start the server in development mode using nodemon.
    4. test: Run tests (if any are defined).
    5. migrate:up Run sequalize migrations
    6. migrate:undo Undo last sequalize migration

## Applying Migrations

1. Go to file src\scripts\migration.script.ts
2. change migrationName: 'add question table' to something relevant,
3. Run Below Command:
   ```bash
   yarn run makemigrations
   ```
4. Verify migrations created in src/data/migration folder and applied to database.

## Endpoints

Below are some example endpoints for the application:

1.  GET /api/users - Get all users
2.  POST /api/users - Create a new user
3.  GET /api/users/:id - Get a user by ID
4.  PUT /api/users/:id - Update a user by ID
5.  DELETE /api/users/:id - Delete a user by ID

## Developement Guidelines

1.  Follow file naming conventions as shown in project structure
2.  Setup Eslint and Prettier for code analysis and formatting
3.  When returning success response from API consider below status codes

    | HTTP METHOD | Status Code | Status Message |
    | ----------- | ----------- | -------------- |
    | GET         | 200         | Ok             |
    | POST        | 201         | Created        |
    | PUT         | 204         | No Content     |
    | PATCH       | 204         | No Content     |
    | DELETE      | 204         | No Content     |

4.  When returning error response from API consider below status codes

    | Reason                          | Status Code | Status Message |
    | ------------------------------- | ----------- | -------------- |
    | Bad data in request             | 400         | Bad Request    |
    | Resource not existing on server | 404         | Not Found      |
    | Unauthorized access             | 401         | Unauthorized   |

## License

This project is sole property of Valt Technologies. Any unauthorized use will have legal implications.
